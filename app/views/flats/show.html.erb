<div class="banner">
</div>
<div class="container">

  <div class="row">
    <div class="flat mt-3">

      <div class="flat-content">
        <div class="flat-header">
          <h1><%= @flat.name %></h1>
          <p><%= @flat.address %></p>
        </div>

        <div class="flat-info">
          <p>A bit more about this flat...</p>
          <p><%= @flat.description %></p>
        </div>

          <div style="width: 100%; height: 600px;"
            data-controller="map"
            data-map-markers-value="<%= @markers.to_json %>"
            data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
          </div>
      </div>

      <div class="flat-booking">
          <h2>Book this place !</h2>

          <div data-controller="pricecalculator" data-pricecalculator-pricepernight-value=<%= @price %> >
            <%= simple_form_for [@flat, @booking]  do |f| %>
            <%= f.input :start_date,
                        as: :string,
                        input_html: { data: { controller: "datepicker", datepicker_date_value: @dates_booking, pricecalculator_target: "start", action: "change->pricecalculator#update"}} %>
            <%= f.input :end_date,
                        as: :string,
                        input_html: { data: { controller: "datepicker", datepicker_date_value: @dates_booking, pricecalculator_target: "end", action: "change->pricecalculator#update"}} %>
            <%= f.submit %>
            <% end %>

            <div>
              <p data-pricecalculator-target="total" ></p>
            </div>
          </div>
      </div>
    </div>

  <div>
    <% if policy(@flat).edit? %>
      <%= link_to 'Edit', edit_flat_path(@flat), class:'btn btn-primary' %>
    <% end %>
    <% if policy(@flat).destroy? %>
      <%= link_to "Delete", flat_path(@flat), data: { turbo_method: :delete, turbo_confirm: "Are you sure?" }, class: 'btn btn-warning' %>
    <% end %>
    </div>
</div>
